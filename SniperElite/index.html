<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sniper Elite - Pixel Precision</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0a0a;
            font-family: 'Share Tech Mono', monospace;
            overflow: hidden;
            height: 100vh;
            color: #00ff00;
            cursor: crosshair;
        }
        
        #gameContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            cursor: none;
        }
        
        #crosshair {
            position: absolute;
            width: 30px;
            height: 30px;
            pointer-events: none;
            z-index: 100;
            opacity: 0.8;
        }
        
        .crosshair-line {
            position: absolute;
            background: #ff0000;
            box-shadow: 0 0 5px #ff0000;
        }
        
        .crosshair-h {
            width: 30px;
            height: 2px;
            top: 14px;
            left: 0;
        }
        
        .crosshair-v {
            width: 2px;
            height: 30px;
            left: 14px;
            top: 0;
        }
        
        .crosshair-center {
            width: 6px;
            height: 6px;
            left: 12px;
            top: 12px;
            border-radius: 50%;
            background: rgba(255, 0, 0, 0.3);
        }
        
        #hud {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 50;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border: 1px solid #00ff00;
            border-radius: 5px;
        }
        
        .hud-item {
            margin: 5px 0;
            font-size: 14px;
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .hud-value {
            color: #ffffff;
            font-weight: bold;
        }
        
        #missionBrief {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 250px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #ff6600;
            border-radius: 5px;
            padding: 15px;
            z-index: 50;
        }
        
        .mission-title {
            color: #ff6600;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 0 5px #ff6600;
        }
        
        .mission-text {
            color: #cccccc;
            font-size: 12px;
            line-height: 1.4;
        }
        
        #scope {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            border: 3px solid #00ff00;
            border-radius: 50%;
            background: rgba(0, 255, 0, 0.1);
            display: none;
            z-index: 75;
            pointer-events: none;
        }
        
        .scope-line {
            position: absolute;
            background: #00ff00;
        }
        
        .scope-h {
            width: 300px;
            height: 1px;
            top: 149px;
            left: 0;
        }
        
        .scope-v {
            width: 1px;
            height: 300px;
            left: 149px;
            top: 0;
        }
        
        #hitMarker {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            color: #ff0000;
            text-shadow: 0 0 10px #ff0000;
            pointer-events: none;
            z-index: 200;
            display: none;
            animation: hitPop 0.5s ease-out;
        }
        
        @keyframes hitPop {
            0% { transform: scale(0.5); opacity: 1; }
            50% { transform: scale(1.5); }
            100% { transform: scale(1); opacity: 0; }
        }
        
        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ff0000;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            z-index: 300;
            display: none;
        }
        
        .game-over-title {
            font-size: 28px;
            color: #ff0000;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #ff0000;
        }
        
        .mission-result {
            font-size: 16px;
            color: #00ff00;
            margin: 10px 0;
        }
        
        .restart-btn {
            background: #ff0000;
            color: white;
            border: none;
            padding: 10px 20px;
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 15px;
        }
        
        .restart-btn:hover {
            background: #cc0000;
        }
        
        .breathing-indicator {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 20px;
            border: 1px solid #00ff00;
            background: rgba(0, 0, 0, 0.5);
            z-index: 50;
        }
        
        .breath-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            transition: width 0.1s ease;
        }
        
        .instructions {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: #888;
            font-size: 12px;
        }
        
        /* Retro scanlines */
        #gameContainer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 50%, rgba(0, 255, 0, 0.03) 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 10;
        }
        
        @media (max-width: 768px) {
            #hud, #missionBrief {
                font-size: 12px;
                padding: 10px;
            }
            
            #crosshair {
                width: 40px;
                height: 40px;
            }
            
            .crosshair-h {
                width: 40px;
                top: 19px;
            }
            
            .crosshair-v {
                height: 40px;
                left: 19px;
            }
            
            .crosshair-center {
                left: 17px;
                top: 17px;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <!-- Crosshair -->
        <div id="crosshair">
            <div class="crosshair-line crosshair-h"></div>
            <div class="crosshair-line crosshair-v"></div>
            <div class="crosshair-center"></div>
        </div>
        
        <!-- Scope overlay -->
        <div id="scope">
            <div class="scope-line scope-h"></div>
            <div class="scope-line scope-v"></div>
        </div>
        
        <!-- HUD -->
        <div id="hud">
            <div class="hud-item">MISSION: <span class="hud-value" id="missionNum">01</span></div>
            <div class="hud-item">TARGETS: <span class="hud-value" id="targets">3</span></div>
            <div class="hud-item">ELIMINATED: <span class="hud-value" id="eliminated">0</span></div>
            <div class="hud-item">ACCURACY: <span class="hud-value" id="accuracy">100%</span></div>
            <div class="hud-item">DISTANCE: <span class="hud-value" id="distance">0m</span></div>
        </div>
        
        <!-- Mission Brief -->
        <div id="missionBrief">
            <div class="mission-title">OPERATION NIGHTFALL</div>
            <div class="mission-text" id="missionText">
                Eliminate all hostile targets.<br>
                Maintain stealth at all costs.<br>
                One shot, one kill.
            </div>
        </div>
        
        <!-- Breathing Indicator -->
        <div class="breathing-indicator">
            <div class="breath-bar" id="breathBar"></div>
        </div>
        
        <!-- Hit Marker -->
        <div id="hitMarker">HEADSHOT</div>
        
        <!-- Game Over Screen -->
        <div id="gameOver">
            <div class="game-over-title" id="gameOverTitle">MISSION COMPLETE</div>
            <div class="mission-result" id="finalStats"></div>
            <button class="restart-btn" onclick="nextMission()">NEXT MISSION</button>
        </div>
        
        <!-- Instructions -->
        <div class="instructions">
            CLICK TO SHOOT • HOLD RIGHT-CLICK FOR SCOPE • HOLD SPACE TO STEADY AIM
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const crosshair = document.getElementById('crosshair');
        const scope = document.getElementById('scope');
        const hitMarker = document.getElementById('hitMarker');
        
        // Game state
        let gameActive = true;
        let currentMission = 1;
        let targets = [];
        let bullets = [];
        let particles = [];
        let shotsFired = 0;
        let targetsEliminated = 0;
        let isScoping = false;
        let breathControl = 100;
        let breathDirection = -1;
        let mouseX = 0;
        let mouseY = 0;
        let steadyAim = false;
        
        // Mission configurations
        const missions = [
            { targets: 3, text: "Eliminate all hostile targets.<br>Maintain stealth at all costs.<br>One shot, one kill." },
            { targets: 4, text: "Multiple targets detected.<br>Take them out quickly.<br>Avoid civilian casualties." },
            { targets: 5, text: "High-value targets identified.<br>Long-range elimination required.<br>Wind compensation needed." },
            { targets: 6, text: "Compound infiltration.<br>Eliminate all hostiles.<br>No survivors." }
        ];
        
        // Resize canvas
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // Target class
        class Target {
            constructor(x, y, type = 'enemy') {
                this.x = x;
                this.y = y;
                this.type = type;
                this.size = 15;
                this.alive = true;
                this.moveSpeed = Math.random() * 0.5 + 0.2;
                this.direction = Math.random() * Math.PI * 2;
                this.health = type === 'boss' ? 3 : 1;
                this.maxHealth = this.health;
                this.patrolRadius = 50 + Math.random() * 100;
                this.originalX = x;
                this.originalY = y;
                this.patrolAngle = 0;
            }
            
            update() {
                if (!this.alive) return;
                
                // Simple patrol movement
                this.patrolAngle += 0.02;
                this.x = this.originalX + Math.cos(this.patrolAngle) * this.patrolRadius * 0.3;
                this.y = this.originalY + Math.sin(this.patrolAngle) * this.patrolRadius * 0.2;
                
                // Keep in bounds
                this.x = Math.max(50, Math.min(canvas.width - 50, this.x));
                this.y = Math.max(100, Math.min(canvas.height - 100, this.y));
            }
            
            draw() {
                if (!this.alive) return;
                
                ctx.save();
                
                // Body
                ctx.fillStyle = this.type === 'boss' ? '#ff6600' : '#ff3333';
                ctx.shadowColor = ctx.fillStyle;
                ctx.shadowBlur = 10;
                ctx.fillRect(this.x - this.size/2, this.y - this.size/2, this.size, this.size);
                
                // Health indicator for boss
                if (this.type === 'boss' && this.health < this.maxHealth) {
                    ctx.fillStyle = '#ff0000';
                    ctx.fillRect(this.x - 15, this.y - 25, 30, 4);
                    ctx.fillStyle = '#00ff00';
                    ctx.fillRect(this.x - 15, this.y - 25, (this.health / this.maxHealth) * 30, 4);
                }
                
                // Target marker
                ctx.strokeStyle = '#ff0000';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size + 5, 0, Math.PI * 2);
                ctx.stroke();
                
                ctx.restore();
            }
            
            hit() {
                this.health--;
                if (this.health <= 0) {
                    this.alive = false;
                    targetsEliminated++;
                    
                    // Create death particles
                    for (let i = 0; i < 15; i++) {
                        particles.push(new Particle(this.x, this.y, '#ff0000'));
                    }
                    
                    return true;
                }
                return false;
            }
            
            isHit(x, y) {
                const dx = x - this.x;
                const dy = y - this.y;
                return Math.sqrt(dx * dx + dy * dy) < this.size;
            }
        }
        
        // Bullet class
        class Bullet {
            constructor(x, y, targetX, targetY) {
                this.x = x;
                this.y = y;
                this.startX = x;
                this.startY = y;
                const dx = targetX - x;
                const dy = targetY - y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                this.speed = 15;
                this.vx = (dx / distance) * this.speed;
                this.vy = (dy / distance) * this.speed;
                this.life = 100;
                this.trail = [];
            }
            
            update() {
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > 10) this.trail.shift();
                
                this.x += this.vx;
                this.y += this.vy;
                this.life--;
                
                // Check target hits
                for (let target of targets) {
                    if (target.alive && target.isHit(this.x, this.y)) {
                        const killed = target.hit();
                        showHitMarker(this.x, this.y, killed ? 'KILL' : 'HIT');
                        return true; // Bullet hit
                    }
                }
                
                return this.life <= 0;
            }
            
            draw() {
                ctx.save();
                
                // Trail
                ctx.strokeStyle = '#ffff00';
                ctx.lineWidth = 2;
                ctx.shadowColor = '#ffff00';
                ctx.shadowBlur = 5;
                
                if (this.trail.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(this.trail[0].x, this.trail[0].y);
                    for (let i = 1; i < this.trail.length; i++) {
                        ctx.lineTo(this.trail[i].x, this.trail[i].y);
                    }
                    ctx.stroke();
                }
                
                // Bullet
                ctx.fillStyle = '#ffffff';
                ctx.shadowBlur = 10;
                ctx.fillRect(this.x - 2, this.y - 2, 4, 4);
                
                ctx.restore();
            }
        }
        
        // Particle class
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 8;
                this.vy = (Math.random() - 0.5) * 8;
                this.color = color;
                this.life = 30;
                this.maxLife = 30;
                this.size = Math.random() * 3 + 1;
            }
            
            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vx *= 0.95;
                this.vy *= 0.95;
                this.life--;
            }
            
            draw() {
                ctx.save();
                ctx.globalAlpha = this.life / this.maxLife;
                ctx.fillStyle = this.color;
                ctx.shadowColor = this.color;
                ctx.shadowBlur = 5;
                ctx.fillRect(this.x, this.y, this.size, this.size);
                ctx.restore();
            }
        }
        
        function initMission() {
            targets = [];
            bullets = [];
            particles = [];
            shotsFired = 0;
            targetsEliminated = 0;
            
            const missionData = missions[(currentMission - 1) % missions.length];
            const targetCount = missionData.targets;
            
            // Create targets
            for (let i = 0; i < targetCount; i++) {
                const x = Math.random() * (canvas.width - 200) + 100;
                const y = Math.random() * (canvas.height - 300) + 150;
                const type = (i === targetCount - 1 && currentMission > 2) ? 'boss' : 'enemy';
                targets.push(new Target(x, y, type));
            }
            
            // Update UI
            document.getElementById('missionNum').textContent = currentMission.toString().padStart(2, '0');
            document.getElementById('targets').textContent = targetCount;
            document.getElementById('eliminated').textContent = '0';
            document.getElementById('accuracy').textContent = '100%';
            document.getElementById('missionText').innerHTML = missionData.text;
            
            gameActive = true;
            document.getElementById('gameOver').style.display = 'none';
        }
        
        function shoot(targetX, targetY) {
            if (!gameActive) return;
            
            shotsFired++;
            
            // Add breathing wobble if not steady
            let wobble = 0;
            if (!steadyAim) {
                wobble = (100 - breathControl) * 0.3;
                targetX += (Math.random() - 0.5) * wobble;
                targetY += (Math.random() - 0.5) * wobble;
            }
            
            const startX = canvas.width * 0.1;
            const startY = canvas.height * 0.9;
            
            bullets.push(new Bullet(startX, startY, targetX, targetY));
            
            // Calculate distance
            const distance = Math.sqrt(Math.pow(targetX - startX, 2) + Math.pow(targetY - startY, 2));
            document.getElementById('distance').textContent = Math.floor(distance) + 'm';
            
            updateAccuracy();
        }
        
        function showHitMarker(x, y, type) {
            hitMarker.textContent = type;
            hitMarker.style.left = x + 'px';
            hitMarker.style.top = y + 'px';
            hitMarker.style.display = 'block';
            
            setTimeout(() => {
                hitMarker.style.display = 'none';
            }, 500);
        }
        
        function updateAccuracy() {
            const accuracy = shotsFired > 0 ? Math.floor((targetsEliminated / shotsFired) * 100) : 100;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }
        
        function updateBreathing() {
            if (steadyAim) {
                breathControl = Math.min(100, breathControl + 2);
            } else {
                breathControl += breathDirection * 0.8;
                if (breathControl <= 0 || breathControl >= 100) {
                    breathDirection *= -1;
                }
            }
            
            const breathBar = document.getElementById('breathBar');
            breathBar.style.width = breathControl + '%';
            
            // Update crosshair shake
            if (!steadyAim && breathControl < 50) {
                const shake = (50 - breathControl) * 0.1;
                crosshair.style.transform = `translate(-50%, -50%) translate(${(Math.random() - 0.5) * shake}px, ${(Math.random() - 0.5) * shake}px)`;
            } else {
                crosshair.style.transform = 'translate(-50%, -50%)';
            }
        }
        
        function checkMissionComplete() {
            const targetCount = missions[(currentMission - 1) % missions.length].targets;
            if (targetsEliminated >= targetCount) {
                gameActive = false;
                
                const accuracy = shotsFired > 0 ? Math.floor((targetsEliminated / shotsFired) * 100) : 100;
                let rating = 'D';
                if (accuracy >= 90) rating = 'S';
                else if (accuracy >= 80) rating = 'A';
                else if (accuracy >= 70) rating = 'B';
                else if (accuracy >= 60) rating = 'C';
                
                document.getElementById('gameOverTitle').textContent = 'MISSION COMPLETE';
                document.getElementById('finalStats').innerHTML = `
                    RATING: ${rating}<br>
                    ACCURACY: ${accuracy}%<br>
                    SHOTS FIRED: ${shotsFired}<br>
                    TARGETS ELIMINATED: ${targetsEliminated}
                `;
                document.getElementById('gameOver').style.display = 'block';
            }
        }
        
        function nextMission() {
            currentMission++;
            initMission();
        }
        
        function gameLoop() {
            // Clear canvas
            ctx.fillStyle = 'rgba(10, 10, 10, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw background grid
            ctx.strokeStyle = 'rgba(0, 255, 0, 0.1)';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            
            // Update and draw targets
            for (let target of targets) {
                target.update();
                target.draw();
            }
            
            // Update and draw bullets
            for (let i = bullets.length - 1; i >= 0; i--) {
                if (bullets[i].update()) {
                    bullets.splice(i, 1);
                } else {
                    bullets[i].draw();
                }
            }
            
            // Update and draw particles
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                } else {
                    particles[i].draw();
                }
            }
            
            // Update game state
            updateBreathing();
            document.getElementById('eliminated').textContent = targetsEliminated;
            
            if (gameActive) {
                checkMissionComplete();
            }
            
            requestAnimationFrame(gameLoop);
        }
        
        // Event listeners
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
            
            crosshair.style.left = e.clientX + 'px';
            crosshair.style.top = e.clientY + 'px';
        });
        
        canvas.addEventListener('click', (e) => {
            if (gameActive) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                shoot(x, y);
            }
        });
        
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });
        
        canvas.addEventListener('mousedown', (e) => {
            if (e.button === 2) { // Right click
                isScoping = true;
                scope.style.display = 'block';
                canvas.style.cursor = 'none';
            }
        });
        
        canvas.addEventListener('mouseup', (e) => {
            if (e.button === 2) { // Right click
                isScoping = false;
                scope.style.display = 'none';
                canvas.style.cursor = 'none';
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                steadyAim = true;
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.code === 'Space') {
                steadyAim = false;
            }
        });
        
        // Touch controls for mobile
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (gameActive) {
                const rect = canvas.getBoundingClientRect();
                const touch = e.touches[0];
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                shoot(x, y);
            }
        });
        
        // Initialize game
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        initMission();
        gameLoop();
    </script>
</body>
</html>